(function (Drupal, once) {
  Drupal.behaviors.footerToggle = {
    attach: function (context) {
      once('hideFooterSubChild', '.has-footer-sub-child', context).forEach((el) => {
        el.classList.remove('active');

        el.querySelectorAll('.has-footer-inner-sub-child').forEach((inner) => {
          inner.classList.remove('active-inner-child');
        });
      });

      once('footerClickEvent', '.footer-menu li > span', context).forEach((link) => {
        link.addEventListener('click', function (e) {
          const parentLi = this.closest('li');
          const subChild = parentLi.querySelector('.has-footer-sub-child');

          if (subChild) {
            e.preventDefault();

            document.querySelectorAll('.has-footer-sub-child.active').forEach((el) => {
              if (el !== subChild) {
                el.classList.remove('active');
              }
            });

            subChild.classList.toggle('active');
          }
        });
      });

      // Toggle inner sub children.
      once('innerFooterClickEvent', '.has-footer-sub-child li > span', context).forEach((innerLink) => {
        innerLink.addEventListener('click', function (e) {
          const parentLi = this.closest('li');
          const innerSubChild = parentLi.querySelector('.has-footer-inner-sub-child');

          if (innerSubChild) {
            e.preventDefault();

            const siblingInnerSubs = parentLi.closest('.has-footer-sub-child')
              .querySelectorAll('.has-footer-inner-sub-child');

            // Remove all active-inner-child from siblings.
            siblingInnerSubs.forEach((el) => {
              if (el !== innerSubChild) {
                el.classList.remove('active-inner-child');
              }
            });

            // Toggle active-inner-child on the clicked one.
            innerSubChild.classList.toggle('active-inner-child');
          }
        });
      });
    }
  };
})(Drupal, once);
