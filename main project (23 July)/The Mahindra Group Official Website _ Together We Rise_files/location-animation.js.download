(function (Drupal, once) {
  Drupal.behaviors.fallInAnimation = {
    attach: function (context, settings) {
      const section = once('fall-in-section', '.our-global', context).shift();
      if (section) {
        /**
         * This function is checking the for every map location pin image and
         * Adding the class visible to add the animation.
         */
        const observer = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const imgs = entry.target.querySelectorAll('.fall-in');
              imgs.forEach((img, index) => {
                setTimeout(() => {
                  img.classList.add('visible');

                }, index * 150);
              });
              observer.unobserve(entry.target);
            }
          });
        }, {
          threshold: 0.6
        });
        observer.observe(section);
      }
    }
  };
})(Drupal, once);
